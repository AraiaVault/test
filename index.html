<link rel="stylesheet" href="style.css">
<style> 
body {  
  background-image: url('image.png'); 
  background-repeat: repeat; 
  background-attachment: fixed; 
}
</style>
<script src="https://kit.fontawesome.com/db2d4e4bde.js" crossorigin="anonymous"></script>
<body class = "head">
	<input class = "search" type="text" required list ="Tile">
	<datalist id="Tile">
		<option value="Medical Info"></option>
		<option value="Passwords"></option>
		<option value="Bank account info"></option>
		<option value="Adresse"></option>
	</datalist> 
	<button type = "button" class = "add-tile" onclick = "openPopup()">+</button>
	<div class = "popup" id = "popup">
		<input type="text" name = "title" required class="tile-name-input" id = "tileTitle">
		<button type = "button" class = "hide" onclick = "closePopup()">x</button>
		<form>
			<div class = "File-Types">
				<button class = "txt" type = "button" onclick = "openTxtInput()"> Txt </button>
				<button class = "txt" type = "button" onclick = "openImgUpload()"> Img </button>
				<button class = "txt" type = "button" onclick = "openTxtInput()"> Mov </button>
			</div>
			<textarea id="txtInput" name="data"  type="text" required class="txt-input" placeholder="Write something.."></textarea>
		</form>
		<div class="uploader">
		        <div id="drop-zone" class="drop-zone" tabindex="0" role="button" aria-label="Click or drag and drop to upload an image">
		            <div id="upload-icon" class="upload-icon">
		                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
		                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
		                    <polyline points="17 8 12 3 7 8"></polyline>
		                    <line x1="12" y1="3" x2="12" y2="15"></line>
		                </svg>
		            </div>
		            <p id="upload-text" class="upload-text">
		                <span class="bold">Click to upload</span> or drag and drop
		            </p>
		            <p class="upload-hint">PNG, JPG, GIF up to 10MB</p>
		            <img id="preview" class="preview" src="" alt="Uploaded image preview" style="display: none;">
		        </div>
		        <input type="file" id="file-input" accept="image/*" aria-hidden="true">
		    </div>
		<button type = "button" class = "done" onclick = "closePopup(); createAndDownloadTile()" id = "saveButton">Save</button>
	</div>
<script>
var popup = document.getElementById("popup");
var txtInput = document.getElementById("txtInput");
var imgUpload = document.getElementById("uploader");
var saveButton = document.getElementById("saveButton");

function openPopup(){
	popup.classList.add("open-popup");
	saveButton.style.display = "none";
}
function closePopup(){
	popup.classList.remove("open-popup");
	uploader.style.display = "none";
	txtInput.style.display = "none";
	document.getElementById('tileTitle').value = '';
        document.getElementById('txtInput').value = '';
	saveButton.style.display = "none";
}
function openTxtInput(){
	txtInput.style.display = "block";
	uploader.style.display = "none";
	saveButton.style.display = "block";
}
function openImgUpload(){
	uploader.style.display = "block";
	txtInput.style.display = "none";
	saveButton.style.display = "block";
}
</script>
</body>
<body class = "main">
	<div class = "flex">
		<div class = "Scrollable">
			<div class="Tile">
				<h1> Tile </h1>
			</div>
			<div class="Tile">
				<h1> Tile </h1>
			</div>
			<div class="Tile">
				<h1> Tile </h1>
			</div>
			<div class="Tile">
				<h1> Tile </h1>
			</div>
			<div class="Tile">
				<h1> Tile </h1>
			</div>
			<div class="Tile">
				<h1> Tile </h1>
			</div>
			<div class="Tile">
				<h1> Tile </h1> 
			</div>
		</div>
	</div>
</body>
<script>
function createAndDownloadTile() {
        const title = document.getElementById('tileTitle').value;
        const content = document.getElementById('tileContent').value;
        const blob = new Blob([content], { type: 'text/plain' });
        const folder = 'vault_tiles';
        const anchor = document.createElement('a');
	anchor.download = `${folder}/${title}.txt`;
	anchor.href = window.URL.createObjectURL(blob);
	document.body.appendChild(anchor);
        anchor.click();
        document.body.removeChild(anchor);
       }

       document.addEventListener('DOMContentLoaded', () => {
            const dropZone = document.getElementById('drop-zone');
            const fileInput = document.getElementById('file-input');
            const uploadIcon = document.getElementById('upload-icon');
            const uploadText = document.getElementById('upload-text');
            const preview = document.getElementById('preview');
            const handleFile = (file) => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        preview.src = e.target.result;
                        preview.style.display = 'block';
                        uploadIcon.style.display = 'none';
                        uploadText.style.display = 'none';
                    };
                    reader.readAsDataURL(file);
                } else {
                    alert('Please upload an image file');
                }
            };
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('dragover');
            });
            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('dragover');
            });
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                handleFile(file);
            });
            dropZone.addEventListener('click', () => {
                fileInput.click();
            });
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                handleFile(file);
            });
</script>
